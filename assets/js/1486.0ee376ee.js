"use strict";(self.webpackChunkvue_book=self.webpackChunkvue_book||[]).push([[1486],{1486:(t,e,a)=>{a.r(e),a.d(e,{default:()=>_});var n=a(66252),s=a(49963);const o={class:"audio-control"},i={id:"boombox"},l=(0,n._)("div",{class:"boombox-handle"},null,-1),r={class:"boombox-body"},c={class:"master-controls"},u=(0,n.uE)('<input type="range" id="volume" class="control-volume" min="0" max="2" value="1" list="gain-vals" step="0.01" data-action="volume"><datalist id="gain-vals"><option value="0" label="min"></option><option value="2" label="max"></option></datalist><label for="volume">VOL</label>',3),d=(0,n._)("datalist",{id:"pan-vals"},[(0,n._)("option",{value:"-1",label:"left"}),(0,n._)("option",{value:"1",label:"right"})],-1),p=(0,n._)("label",{for:"panner"},"PAN",-1),h=(0,n._)("button",{class:"control-power",role:"switch","aria-checked":"false","data-power":"on"},[(0,n._)("span",null,"On/Off")],-1),m={class:"tape"},v=["src"],f={"data-playing":"false",class:"tape-controls-play",role:"switch",ref:"playButton","aria-checked":"false"},b=[(0,n._)("span",null,"Play/Pause",-1)];var y=a(9669),g=a.n(y);const w={name:"audioControl",data:()=>({panval:0,tag:0,panSpeed:1,musicUrl:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/858/outfoxing.mp3"}),methods:{initWebAudioApi(){let t=this;const e=new(window.AudioContext||window.webkitAudioContext),a=document.querySelector("audio"),n=e.createMediaElementSource(a),s=document.querySelector(".tape-controls-play");s.addEventListener("click",(function(){"suspended"===e.state&&e.resume(),"false"===this.dataset.playing?(a.play(),this.dataset.playing="true"):"true"===this.dataset.playing&&(a.pause(),this.dataset.playing="false");let n="true"===this.getAttribute("aria-checked");this.setAttribute("aria-checked",n?"false":"true"),t.startEnd()}),!1),a.addEventListener("ended",(()=>{s.dataset.playing="false",s.setAttribute("aria-checked","false")}),!1);const o=e.createGain();document.querySelector('[data-action="volume"]').addEventListener("input",(function(){o.gain.value=this.value}),!1);const i=new StereoPannerNode(e,{pan:0});document.querySelector('[data-action="panner"]').addEventListener("input",(function(){i.pan.value=this.value}),!1),n.connect(o).connect(i).connect(e.destination),document.querySelector(".control-power").addEventListener("click",(function(){"on"===this.dataset.power?(e.suspend(),this.dataset.power="off",clearInterval(this.time2),clearInterval(this.time1)):"off"===this.dataset.power&&(e.resume(),this.dataset.power="on"),this.setAttribute("aria-checked",state?"false":"true"),console.log(e.state)}),!1)},queryMusic(){try{g()({method:"get",url:"https://api.uomg.com/api/rand.music",params:{format:"json"},headers:{}}).then((t=>{t.status})).catch((t=>{this.$message.error("出错了")}))}catch(t){this.$message.error("出错了")}},dispatchInput(){document.querySelector('[data-action="panner"]').dispatchEvent(new Event("input"))},startEnd(){let t=this;clearInterval(t.time2),this.time1=setInterval((function(){t.panval-=t.panSpeed,t.tag+=.001,t.dispatchInput(),t.panval<=-1&&t.endStatrt()}),100)},endStatrt(){let t=this;clearInterval(t.time1),this.time2=setInterval((function(){t.panval+=t.panSpeed,t.tag+=.001,t.dispatchInput,t.panval>1&&t.startEnd()}),100)}},mounted(){console.clear(),this.initWebAudioApi(),this.queryMusic();let t=this;this.$nextTick((function(){t.$refs.playButton,setTimeout((function(){}),2e3)}))},watch(){}},_=(0,a(83744).Z)(w,[["render",function(t,e,a,y,g,w){return(0,n.wg)(),(0,n.iD)("div",o,[(0,n._)("div",i,[l,(0,n._)("div",r,[(0,n._)("section",c,[u,(0,n.wy)((0,n._)("input",{type:"range",id:"panner",class:"control-panner",list:"pan-vals",min:"-1",max:"1","onUpdate:modelValue":e[0]||(e[0]=t=>g.panval=t),step:"0.01","data-action":"panner"},null,512),[[s.vModelText,g.panval]]),d,p,h]),(0,n._)("section",m,[(0,n._)("audio",{src:g.musicUrl,crossorigin:"anonymous"},null,8,v),(0,n._)("button",f,b,512)])])])])}]])}}]);